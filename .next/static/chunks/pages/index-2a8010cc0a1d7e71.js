(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5989)}])},1398:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(5893),s=r(9008),a=r.n(s),o=r(1664),i=r.n(o);function c(e){let{children:t}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"Warriors Game AI Commentary"}),(0,n.jsx)("meta",{name:"description",content:"AI-powered commentary for Warriors games"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)("nav",{className:"bg-black text-neon-green p-4",children:(0,n.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,n.jsx)(i(),{href:"/",className:"text-2xl font-bold text-neon-green",children:"Warriors AI Commentary"}),(0,n.jsxs)("ul",{className:"flex space-x-4",children:[(0,n.jsx)("li",{children:(0,n.jsx)(i(),{href:"/",className:"hover:text-green-400",children:"Home"})}),(0,n.jsx)("li",{children:(0,n.jsx)(i(),{href:"/analytics",className:"hover:text-green-400",children:"Analytics"})})]})]})}),(0,n.jsx)("main",{children:t})]})}},5989:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(5893),s=r(1398),a=r(7294);function o(e){let{commentary:t,onSendMessage:r,showAIMessages:s,onToggleAIMessages:o,onGenerateCommentary:i,isAIWatching:c,isSpeaking:l}=e,d=(0,a.useRef)(null),[u,h]=(0,a.useState)("");return(0,a.useEffect)(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[t]),(0,n.jsxs)("div",{className:"commentary bg-black rounded-lg flex flex-col h-full",children:[" ",(0,n.jsxs)("div",{className:"p-4 bg-black border-b border-gray-600",children:[" ",(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2 text-neon-green",children:"Live Chat"}),(0,n.jsx)("button",{onClick:o,className:"bg-green-600 text-white px-4 py-2 rounded-md w-full hover:bg-green-700",children:s?"Hide AI Messages":"Show AI Messages"})]}),(0,n.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 bg-black",ref:d,children:[" ",(0,n.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,n.jsxs)("div",{className:"p-3 rounded shadow ".concat("user"===e.type?"bg-green-600 text-white text-right":"bg-gray-700"),children:[(0,n.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()}),(0,n.jsx)("p",{className:"mt-1",children:e.text})]},t))})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u.trim()&&(r(u),h(""))},className:"p-4 bg-black border-t border-gray-600 flex gap-2",children:[" ",(0,n.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Type your message...",className:"flex-grow px-3 py-2 bg-gray-600 text-white rounded-l-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,n.jsx)("button",{type:"submit",className:"send bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Send"}),(0,n.jsx)("button",{type:"button",onClick:i,className:"generate-commentary bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",disabled:c||l,children:c?"Generating...":l?"Speaking...":"Generate"})]})]})}function i(e){let{videoSrc:t}=e,r=(0,a.useRef)(null),[s,i]=(0,a.useState)(null),[c,l]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[h,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=r.current,t=()=>{console.log("Video playback started")},n=()=>{console.log("Video playback paused")},s=e=>{console.error("Video error:",e),i("Error loading video. Please check the video source.")};return e.addEventListener("play",t),e.addEventListener("pause",n),e.addEventListener("error",s),()=>{e.removeEventListener("play",t),e.removeEventListener("pause",n),e.removeEventListener("error",s)}},[]);let p=async()=>{try{m(!0);let e=document.createElement("canvas"),t=r.current;e.width=t.videoWidth,e.height=t.videoHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height);let n=e.toDataURL("image/jpeg"),s=await fetch("/api/commentary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:n,width:e.width,height:e.height})}),a=await s.json();a.text&&(l(e=>[...e,{...a,type:"ai"}]),f(a.text)),m(!1)}catch(e){console.error("Error generating commentary:",e),i("Error generating commentary. Please check the console for details."),m(!1)}},f=async e=>{x(!0);let t=r.current;t.muted=!0;try{let r=await fetch("/api/text-to-speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})}),n=new(window.AudioContext||window.webkitAudioContext),s=n.createBufferSource(),a=await r.arrayBuffer();n.decodeAudioData(a,e=>{s.buffer=e,s.connect(n.destination),s.start(0)}),s.onended=()=>{t.muted=!1,x(!1)}}catch(e){console.error("Error playing speech from server:",e),t.muted=!1,x(!1)}};return(0,n.jsxs)("div",{className:"main-container",children:[(0,n.jsxs)("div",{className:"video-container p-4",children:[(0,n.jsx)("video",{ref:r,src:t,controls:!0,crossOrigin:"anonymous",className:"w-full h-auto max-h-full bg-black border border-gray-700"}),s&&(0,n.jsx)("p",{className:"text-red-500 mt-2",children:s})]}),(0,n.jsx)("div",{className:"sidebar-container p-4",children:(0,n.jsx)(o,{commentary:c,showAIMessages:d,onToggleAIMessages:()=>u(!d),onGenerateCommentary:p,isAIWatching:h,isSpeaking:g})})]})}function c(){return(0,n.jsx)(s.Z,{children:(0,n.jsx)(i,{videoSrc:"/sample-video.mp4"})})}}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);